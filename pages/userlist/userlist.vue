<template>
	<view class="body">
		<!-- åˆ‡æ¢å¯¼èˆª -->
		<swiperHead
		:tablist="tablist"
		:tabindex="tabindex"
		:linewidth="linewidth"
		:scroll="scroll"
		@tabtap="tabtap"
		itemwidth="width:33.3%;"
		></swiperHead>
		
		<view class="uni-tab-bar">
		 <swiper class="swiper-box" :style="{height:swheigth+'px'}" :current="tabindex" @change="watchchange"> 
				<swiper-item v-for="(items,index1) in newlist" :key="index1">
					 <scroll-view scroll-y class="list" @scrolltolower="loadtop(index1)" 
					  scroll-with-animation="true">
						<template v-if="items.list.length>0">
						    <!-- å¥½å‹åˆ—è¡¨ -->
							<block v-for="(item,index) in items.list" :key="index">
							   	<userList :item="item" :index="index"></userList>
							</block>
							 <!--ä¸Šæ‹‰åŠ è½½-->
							<loadMore :loadtext="items.loadtext"></loadMore>
						</template>
						<template v-else>
							 <!--æ— æ•°æ®-->
							<noThing></noThing>
						</template>
					 </scroll-view>
				</swiper-item>
		</swiper>
		</view>
	</view>
</template>

<script>
	import swiperHead from "../../compoents/index/swiper-head.vue";
	import userList from "../../compoents/user-list/user-list.vue";
	import loadMore from '../../compoents/common/load-more.vue';
	import noThing from '../../compoents/common/no-thing.vue';
	export default {
		components:{
			swiperHead,
			userList,
			loadMore,
			noThing
		},
		data(){
			return{
				swheigth:0,
				tabindex:0,
				linewidth:38,
				scroll:0,
				tablist:[
					{name:"äº’å…³",id:"huguan",num:10},
					{name:"å…³æ³¨",id:"guanzhu",num:10},
					{name:"ç²‰ä¸",id:"fensi",num:10}
				],
				newlist:[
					{ 
					  loadtext:"ä¸Šæ‹‰åŠ è½½æ›´å¤šðŸ‘†",
					  list:[{
					  	userpic:'../../static/userpic/10.jpg',
					  	username:'è€é©¬',
					  	age:'25',
					  	sex:0,
					  	isguanzhu:false
					  },{
					  	userpic:'../../static/userpic/10.jpg',
					  	username:'å¥‡è‘©',
					  	age:'18',
					  	sex:1,
					  	isguanzhu:true
					  },{
					  	userpic:'../../static/userpic/10.jpg',
					  	username:'è€é©¬',
					  	age:'25',
					  	sex:0,
					  	isguanzhu:false
					  },{
					  	userpic:'../../static/userpic/10.jpg',
					  	username:'å¥‡è‘©',
					  	age:'18',
					  	sex:1,
					  	isguanzhu:true
					  },{
					  	userpic:'../../static/userpic/10.jpg',
					  	username:'è€é©¬',
					  	age:'25',
					  	sex:0,
					  	isguanzhu:false
					  },{
					  	userpic:'../../static/userpic/10.jpg',
					  	username:'å¥‡è‘©',
					  	age:'18',
					  	sex:1,
					  	isguanzhu:true
					  },{
					  	userpic:'../../static/userpic/10.jpg',
					  	username:'è€é©¬',
					  	age:'25',
					  	sex:0,
					  	isguanzhu:false
					  },{
					  	userpic:'../../static/userpic/10.jpg',
					  	username:'å¥‡è‘©',
					  	age:'18',
					  	sex:1,
					  	isguanzhu:true
					  },{
					  	userpic:'../../static/userpic/10.jpg',
					  	username:'å¥‡è‘©',
					  	age:'18',
					  	sex:1,
					  	isguanzhu:true
					  },{
					  	userpic:'../../static/userpic/10.jpg',
					  	username:'å¥‡è‘©',
					  	age:'18',
					  	sex:1,
					  	isguanzhu:true
					  },{
					  	userpic:'../../static/userpic/10.jpg',
					  	username:'å¥‡è‘©',
					  	age:'18',
					  	sex:1,
					  	isguanzhu:true
					  },{
					  	userpic:'../../static/userpic/10.jpg',
					  	username:'å¥‡è‘©',
					  	age:'18',
					  	sex:1,
					  	isguanzhu:true
					  }],
					  	
					},{
						loadtext:"ä¸Šæ‹‰åŠ è½½æ›´å¤šðŸ‘†",
						list:[{
							userpic:'../../static/userpic/10.jpg',
							username:'è€é©¬',
							age:'25',
							sex:0,
							isguanzhu:false
						},{
							userpic:'../../static/userpic/10.jpg',
							username:'å¥‡è‘©',
							age:'18',
							sex:1,
							isguanzhu:true
						}],
					},{ 
						loadtext:"ä¸Šæ‹‰åŠ è½½æ›´å¤šðŸ‘†",
						list:[],
					}
				]
			}
		},
		methods:{
			//ç›‘å¬å¯¼èˆªçš„index
		watchchange(e){
				this.tabindex=e.detail.current;
			},
		tabtap(index){
				this.tabindex=index;
			},
		//ä¸Šæ‹‰äº‹ä»¶
		loadtop(index1){
			if(this.newlist[index1].loadtext!="ä¸Šæ‹‰åŠ è½½æ›´å¤šðŸ‘†"){return;}					
			this.newlist[index1].loadtext="åŠ è½½ä¸­o(*ï¿£â–½ï¿£*)ãƒ–";
			setTimeout(()=> {
				let obj={
					userpic:'../../static/userpic/11.jpg',
					username:'é©¬åŒ–è…¾',
					age:'25',
					sex:0,
					isguanzhu:false
						};
				this.newlist[index1].list.push(obj);
				this.newlist[index1].loadtext="ä¸Šæ‹‰åŠ è½½æ›´å¤šðŸ‘†";
				//this.newlist[index1].loadtext="æ²¡æœ‰æ›´å¤šæ•°æ®äº†/(ã„’oã„’)/~~";
			}, 1000);
		}	
		},
		onLoad() {	
		uni.getSystemInfo({
		    success:(res)=> {
		        let height=res.windowHeight-uni.upx2px(100);
				this.swheigth=height;	
		    }
		});				  
		},
		onNavigationBarButtonTap(e) {
			if(e.index==0){
				uni.navigateBack({
					delta:1
				})
			}	
		}
		
	}
</script>

<style>

</style>
