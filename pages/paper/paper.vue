<template>
	<view class="big animated fadeInLeft fast">
		<!-- å¼¹å‡º -->
		<paperPop 
		:showpop="showpop"
		@hidepop="hidepop"
		@friends="friends"
		@clear="clear"
		></paperPop>
		<block v-for="(item,index) in list" :key="index">
			<paperList :item="item"></paperList>
		</block>
		<!--ä¸Šæ‹‰åŠ è½½-->
		<loadMore :loadtext="loadtext"></loadMore>
		<!-- æ²¡æœ‰æ»šåŠ¨æ¡ï¼Œè®©å®ƒä¸ºç©º -->
	</view>
</template>

<script>
	import paperList from "../../compoents/paper/paper-list.vue";
	import loadMore from "../../compoents/common/load-more.vue";
	import paperPop from "../../compoents/paper/paper-pop.vue"
	export default {
		components:{
			paperList,
			loadMore,
			paperPop
		},
		data() {
			return {
				showpop:false,
				loadtext:"ä¸Šæ‹‰åŠ è½½æ›´å¤šğŸ‘†",
				list:[
					{   
						paperimg:'../../static/userpic/10.jpg',
						papertitle:'æ ‡é¢˜',
						paperinfo:'æˆ‘æ˜¯ä¿¡æ¯0',
						papertime:'13:58',
						papertext:'10'					
					},
					{
						paperimg:'../../static/userpic/10.jpg',
						papertitle:'æ ‡é¢˜',
						paperinfo:'æˆ‘æ˜¯ä¿¡æ¯',
						papertime:'13:58',
						papertext:'0'				
					},
					{
						paperimg:'../../static/userpic/10.jpg',
						papertitle:'æ ‡é¢˜',
						paperinfo:'æˆ‘æ˜¯ä¿¡æ¯',
						papertime:'13:58',
						papertext:'2'					
					},
					{
						paperimg:'../../static/userpic/10.jpg',
						papertitle:'æ ‡é¢˜',
						paperinfo:'æˆ‘æ˜¯ä¿¡æ¯',
						papertime:'13:58',
						papertext:'22'					
					},
					{
						paperimg:'../../static/userpic/10.jpg',
						papertitle:'æ ‡é¢˜',
						paperinfo:'æˆ‘æ˜¯ä¿¡æ¯0',
						papertime:'13:58',
						papertext:'10'					
					},
					{
						paperimg:'../../static/userpic/10.jpg',
						papertitle:'æ ‡é¢˜',
						paperinfo:'æˆ‘æ˜¯ä¿¡æ¯',
						papertime:'13:58',
						papertext:'0'				
					}
				],
				winHeight:'',
				pageHeight:''
			}
		},
		onReachBottom() {
			this.loadtop();
		},
		onNavigationBarButtonTap(e){
			switch (e.index){
				case 0:
				    this.showpop=false;
					uni.navigateTo({
						url:'../userlist/userlist'
					})
					break;
				case 1:
				    this.showpop=true;
					break;
			}
		},
		methods: {
			//éšè—é®ç½©
			hidepop(){
				this.showpop=false; 
			},	
			//åŠ å¥½å‹
			friends(){
			  // console.log('åŠ å¥½å‹');
			   this.showpop=false;
			},
			clear(){
				//console.log('æ¸…é™¤');
				this.showpop=false;
			},	
			//ä¸Šæ‹‰åŠ è½½
			loadtop(){
				if(this.loadtext!="ä¸Šæ‹‰åŠ è½½æ›´å¤šğŸ‘†"){return;}					
				this.loadtext="åŠ è½½ä¸­o(*ï¿£â–½ï¿£*)ãƒ–";
				setTimeout(()=> {
					let obj={
						paperimg:'../../static/userpic/10.jpg',
						papertitle:'æ ‡é¢˜',
						paperinfo:'æˆ‘æ˜¯ä¿¡æ¯',
						papertime:'13:58',
						papertext:'22'					
					};
					this.list.push(obj);
					this.loadtext="ä¸Šæ‹‰åŠ è½½æ›´å¤šğŸ‘†";				  
					//this.loadtext="æ²¡æœ‰æ›´å¤šæ•°æ®äº†/(ã„’oã„’)/~~";				 
				}, 1000);				
			},	
			//å¤šå‡ºçš„å­—ç”¨ç‚¹æ˜¾ç¤º
			jsu(){
				for (let i=0; i<this.list.length;i++) {
					if(this.list[i].paperinfo.length>4){
						this.list[i].paperinfo=this.list[i].paperinfo.substring(0,4)+'...';
						//substring(start,end)è¡¨ç¤ºä»startåˆ°endä¹‹é—´çš„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬startä½ç½®çš„å­—ç¬¦ä½†æ˜¯ä¸åŒ…æ‹¬endä½ç½®çš„å­—ç¬¦ã€‚
					}
				}
			},
			getdata(){					
				setTimeout(()=> {
					//è·å–æ•°æ®
					let arr=[
						{
							paperimg:'../../static/userpic/10.jpg',
							papertitle:'é©¬äº‘',
							paperinfo:'å€Ÿæˆ‘ç‚¹é’±èŠ±å§ï¼',
							papertime:'13:58',
							papertext:'10'					
						},
						{
							paperimg:'../../static/userpic/10.jpg',
							papertitle:'ç‹å¥æ—',
							paperinfo:'æˆ‘ç ´äº§äº†ï¼',
							papertime:'13:58',
							papertext:'0'				
						},
						{
							paperimg:'../../static/userpic/10.jpg',
							papertitle:'å·´è²ç‰¹',
							paperinfo:'æˆ‘æ•™ä½ ç‚’è‚¡å•Šï¼',
							papertime:'13:58',
							papertext:'2'					
						},
						 {
						 	paperimg:'../../static/userpic/10.jpg',
						 	papertitle:'é©¬äº‘',
						 	paperinfo:'å€Ÿæˆ‘ç‚¹é’±èŠ±å§ï¼',
						 	papertime:'13:58',
						 	papertext:'10'					
						 },
						 {
						 	paperimg:'../../static/userpic/10.jpg',
						 	papertitle:'ç‹å¥æ—',
						 	paperinfo:'æˆ‘ç ´äº§äº†ï¼',
						 	papertime:'13:58',
						 	papertext:'0'				
						 },
						 {
						 	paperimg:'../../static/userpic/10.jpg',
						 	papertitle:'å·´è²ç‰¹',
						 	paperinfo:'æˆ‘æ•™ä½ ç‚’è‚¡å•Šï¼',
						 	papertime:'13:58',
						 	papertext:'2'					
						 },
						  {
						  	paperimg:'../../static/userpic/10.jpg',
						  	papertitle:'é©¬äº‘',
						  	paperinfo:'å€Ÿæˆ‘ç‚¹é’±èŠ±å§ï¼',
						  	papertime:'13:58',
						  	papertext:'10'					
						  },
						  {
						  	paperimg:'../../static/userpic/10.jpg',
						  	papertitle:'ç‹å¥æ—',
						  	paperinfo:'æˆ‘ç ´äº§äº†ï¼',
						  	papertime:'13:58',
						  	papertext:'0'				
						  },
						  {
						  	paperimg:'../../static/userpic/10.jpg',
						  	papertitle:'å·´è²ç‰¹',
						  	paperinfo:'æˆ‘æ•™ä½ ç‚’è‚¡å•Šï¼',
						  	papertime:'13:58',
						  	papertext:'2'					
						  },
						  {
						  	paperimg:'../../static/userpic/10.jpg',
						  	papertitle:'é©¬äº‘',
						  	paperinfo:'å€Ÿæˆ‘ç‚¹é’±èŠ±å§ï¼',
						  	papertime:'13:58',
						  	papertext:'10'					
						  },
						  {
						  	paperimg:'../../static/userpic/10.jpg',
						  	papertitle:'ç‹å¥æ—',
						  	paperinfo:'æˆ‘ç ´äº§äº†ï¼',
						  	papertime:'13:58',
						  	papertext:'0'				
						  },
						  {
						  	paperimg:'../../static/userpic/10.jpg',
						  	papertitle:'å·´è²ç‰¹',
						  	paperinfo:'æˆ‘æ•™ä½ ç‚’è‚¡å•Šï¼',
						  	papertime:'13:58',
						  	papertext:'2'					
						  } 
					];
					//èµ‹å€¼
					this.list=arr;
					//å¤šå‡ºçš„å­—ç”¨ç‚¹æ˜¾ç¤º
					this.jsu();
					//å…³é—­ä¸‹æ‹‰åˆ·æ–°
					uni.stopPullDownRefresh();
				}, 1000);
			},
			/* watchsoroll(){
				let that = this;
				const query = uni.createSelectorQuery().in(this);
				query.select('.big').boundingClientRect(data => {
					that.pageHeight = data.bottom;
				  // console.log("å¾—åˆ°å¸ƒå±€ä½ç½®ä¿¡æ¯" + JSON.stringify(data));
				}).exec();
				if(that.winHeight<that.pageHeight){//å‡ºç°æ»šåŠ¨
					console.log('æˆ‘æ˜¯æ»šåŠ¨æ¡',that.winHeight,that.pageHeight);
					this.loadtext='ä¸Šæ‹‰åŠ è½½æ›´å¤šğŸ‘†';
				}else{
					console.log('æ»šåŠ¨æ¡æ¶ˆå¤±')
				    this.loadtext='';//å¯ä»¥å•¦ï¼Œæˆ‘è‡ªå·±å†æ”¹ä¸€ä¸‹å°±è¡Œäº†ï¼å—¯	
				}
			} */
		},
		onPullDownRefresh() {
			 this.getdata(); 
		 },
		onLoad() {
			this.jsu();
			/* let that = this;
			uni.getSystemInfo({
			    success: function (res){
					//that.winHeight = res.windowHeight;
			         console.log(res);
			    }
			}); */
		
		},
		mounted(){
			//this.watchsoroll();
		},
		onPageScroll(){
			//this.watchsoroll();
		},
		onShow() {
			//this.watchsoroll();
		}
		
	
		
	}
</script>

<style>
.big{
	padding: 0 20upx;
}
</style>
